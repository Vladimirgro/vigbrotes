{% extends "/vistas/brotes.html" %}
{% from "/vistas/macros.html" import input_field, select_field, textarea_field, checkbox_field, radio_field, form_buttons %}

{% block views %}
<main class="main-container">  
  <div class="card-brote">
    <h2>Registro de Brotes</h2>
    <form method="POST" action="{{ url_for('brotes_bp.register_brotes') }}" enctype="multipart/form-data">
      
      {{ input_field("Folio notinmed:", "folNotinmed", "folNotinmed", value=folionotinmed, placeholder="Ingresa folio notinmed") }}
      {{ input_field("Fecha de notificación notinmed:", "fecNotnotinmed", "fecNotnotinmed", type="date", value=fechnotinmed, required=True) }}

      {{ select_field("Tipo de evento:", "evento", "evento", 
        [
          ("BROTE COMUNITARIO", "BROTE COMUNITARIO"),
          ("BROTE ESCOLAR", "BROTE ESCOLAR"),
          ("BROTE FAMILIAR", "BROTE FAMILIAR"),
          ("BROTE FORANEO", "BROTE FORÁNEO"),
          ("BROTE LOCALIZADO", "BROTE LOCALIZADO"),
          ("BROTE NOSOCOMIAL", "BROTE NOSOCOMIAL"),
          ("CLUSTER", "CLUSTER")
        ], selected_option=tipoevento, required=True) }}

      {{ input_field("Unidad notificante:", "unidad", "unidad", value=unidadnotif, placeholder="Ingresa nombre de la unidad", required=True) }}

      {{ select_field("Institución:", "institucion", "institucion", 
        [
          ("IMSS Bienestar", "IMSS Bienestar"),
          ("IMSS Oportunidades", "IMSS OPD"),
          ("IMSS RO", "IMSS RO"),
          ("ISSSTE", "ISSSTE"),
          ("Otras", "OTRAS"),
          ("DIF", "DIF"),
          ("PEMEX", "PEMEX")
        ], selected_option=institucion, required=True) }}

      {{ input_field("Fecha de inicio del brote:", "fechainicio", "fechainicio", type="date", value=fechinicio, required=True) }}
      {{ input_field("Fecha de notificación:", "fechanotifica", "fechanotifica", type="date", value=fechnotifica, required=True) }}

      {{ select_field("Diagnóstico de sospecha:", "diagsospecha", "diagsospecha", 
        diagnosticos | map(attribute="diagnostico") | list, selected_option=diagsospecha, required=True) }}

      {{ select_field("Distrito:", "juris", "juris", 
        distritos | map(attribute="distrito") | list, selected_option=jurisdiccion, required=True) }}

      {{ select_field("Municipio:", "municipio", "municipio", 
        municipios | map(attribute="mun") | list, selected_option=municipio, required=True) }}

      {{ input_field("Localidad:", "unilocalidaddad", "unilocalidaddad", value=unilocalidaddad, placeholder="Ingresa nombre de la localidad", required=True) }}
      {{ input_field("Población masculina expuesta:", "pobmascexpuesta", "pobmascexpuesta", type="number", value=pobmascexp, required=True) }}
      {{ input_field("Población femenina expuesta:", "pobfemexpuesta", "pobfemexpuesta", type="number", value=pobfemexp, required=True) }}
      {{ input_field("Casos probables:", "probables", "probables", type="number", value=casosprob, required=True) }}
      {{ input_field("Casos confirmados:", "confirmados", "confirmados", type="number", value=casosconf, required=True) }}
      {{ input_field("Defunciones:", "defunciones", "defunciones", type="number", value=defunciones, required=True) }}
      {{ input_field("Fecha último caso:", "fecUcaso", "fecUcaso", type="date", value=fechultimocaso, required=True) }}
      {{ input_field("Fecha alta:", "fechalta", "fechalta", type="date", value=fechalta) }}
      {{ input_field("Resultado:", "resultado", "resultado", type="text", value=resultado) }}
      {{ input_field("Folio alta notinmed:", "folAltaNoti", "folAltaNoti", type="text", value=folioaltanotin) }}
      {{ input_field("Fecha alta  notinmed:", "fecAltaNotinmed", "fecAltaNotinmed", type="date", value=fechaltanotin) }}

      {{ select_field("Se realizó nota:", "nota", "nota", 
        [
          ("SI", "SI"),
          ("NO", "NO")          
        ], selected_option=nota) }}
      
      {{ select_field("Tipo de notificación:", "tipo_notificacion", "tipo_notificacion", 
        [
          ("notificacion_inicial", "Notificación inicial"),
          ("seguimiento", "Seguimiento"),
          ("notificacion_final", "Notificación final"),
          ("nota", "Nota")
        ], selected_option=tipo_notificacion) }}
    
      {{ input_field("Adjuntar documentos:", "archivo", "archivo", type="file", accept=".pdf,.jpg,.jpeg,.png,.doc,.docx,.xlsx") }}

      {{ form_buttons() }}

    </form>
  </div>
</main>
{% endblock %}
